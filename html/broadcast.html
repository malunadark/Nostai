<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>NOSTAI — Вещательная</title>
  <style>
    @font-face {
      font-family: 'DestroyCyr';
      src: url('assets/fonts/destroycyr.ttf') format('truetype');
    }

    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      background: #000;
      color: #e3e3e3;
      font-family: 'DestroyCyr', sans-serif;
      position: relative;
    }

    /* Фон */
    body::before {
      content: '';
      position: absolute;
      inset: 0;
      background: url('assets/images/broadcast-bg.png') center/cover no-repeat;
      opacity: 0.5; /* увеличил для видимости */
      z-index: -1;
    }

    /* Контейнер сообщений */
    #messages {
      position: absolute;
      top: 20px;
      left: 40px;
      width: calc(100% - 80px);
      height: calc(100% - 100px);
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      gap: 6px;
      font-size: 16px;
      line-height: 1.3;
      overflow-y: auto;
    }

    .msg {
      font-size: 16px;
      line-height: 1.2;
      margin-bottom: 4px;
    }

    /* Цвета фракций */
    .volunteers { color: #ffb347; }  /* Волонтёры */
    .army { color: #00aaff; }        /* ВС РФ */
    .redcross { color: #ff6b6b; }    /* Красный Крест */
    .emerg { color: #ffdd55; }       /* МЧС */

    /* Строка ввода */
    #inputContainer {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      padding: 12px 20px;
      background: rgba(0, 0, 0, 0.5);
      border-top: 1px solid rgba(255, 255, 255, 0.2);
    }

    #inputField {
      width: 100%;
      background: none;
      border: none;
      outline: none;
      color: #fff;
      font-family: inherit;
      font-size: 16px;
      padding: 6px;
    }

    /* Радио эффект */
    .radio-flash::before {
      content: '';
      position: fixed;
      inset: 0;
      background: radial-gradient(circle, rgba(255,255,255,0.1), transparent 70%);
      opacity: 0;
      animation: flash 0.2s ease;
      z-index: 2;
      pointer-events: none;
    }

    @keyframes flash {
      0% { opacity: 0.2; }
      50% { opacity: 0.6; }
      100% { opacity: 0; }
    }

    /* Помехи на фоне */
    .noise {
      position: fixed;
      inset: 0;
      background: repeating-linear-gradient(
        0deg,
        rgba(255,255,255,0.05),
        rgba(255,255,255,0.05) 1px,
        transparent 1px,
        transparent 2px
      );
      opacity: 0.03;
      animation: noiseMove 1s infinite linear;
      pointer-events: none;
      z-index: 1;
    }

    @keyframes noiseMove {
      from { background-position: 0 0; }
      to { background-position: 0 100%; }
    }
  </style>
</head>
<body>
  <div class="noise"></div>
  <div id="messages"></div>

  <div id="inputContainer">
    <input id="inputField" type="text" placeholder="Введите сообщение..." />
  </div>

  <audio id="radioNoise" src="assets/music/radio_noise.mp3" preload="auto"></audio>
  <audio id="radioBeep" src="assets/music/radio_beep.mp3" preload="auto"></audio>

<script>
const panel = document.getElementById('messages');

// Звуки
const beep = new Audio('assets/music/radio_beep.mp3');
const noise = new Audio('assets/music/radio_noise.mp3');
beep.volume = 0.6;
noise.volume = 0.2;

// Фракции
const factions = [
  { name: 'ВС РФ', prefix: '[АЛЬФА]', color: '#00aaff', class:'army', messages: [
    'Пятый сектор под контролем. Повторяю, сектор под контролем.',
    'Обнаружено свечение в районе координат 54°... Проверяем.',
    'Поступило распоряжение — никому не покидать периметр.',
    'Радиосвязь с постом «Север» прервана, выясняем причину.'
  ]},
  { name: 'МЧС', prefix: '[СПАСЕНИЕ]', color: '#ffdd55', class:'emerg', messages: [
    'Задымление в квадрате D7 усиливается.',
    'Нужны добровольцы для эвакуации оставшихся.',
    'Пламя переходит к старым шахтам. Берегитесь газа.',
    'Приём, кто видит сигнальные ракеты на востоке?'
  ]},
  { name: 'Красный Крест', prefix: '[КРАСНЫЙ КРЕСТ]', color: '#ff6b6b', class:'redcross', messages: [
    'Требуется помощь медиков, запас перевязок исчерпан.',
    'Приняли раненых из отряда «Альфа». Состояние тяжёлое.',
    'Точка приёма в лагере «Горный» восстановлена.',
    'Нужен транспорт, повторяю, нужен транспорт!'
  ]},
  { name: 'Волонтёры', prefix: '[ВОЛОНТЁРЫ]', color: '#ffb347', class:'volunteers', messages: [
    'Мы всё ещё в живых. Кто рядом — ответьте.',
    'Нашли следы. Кажется, не человеческие.',
    'Река светится... никто не верит, пока не видит сам.',
    'Ветер говорит — уходите. Но мы остались.'
  ]}
];

// Генерация сообщений
function generateRadioMessage() {
  const faction = factions[Math.floor(Math.random() * factions.length)];
  const message = faction.messages[Math.floor(Math.random() * faction.messages.length)];

  // Звуки
  beep.currentTime = 0;
  noise.currentTime = 0;
  beep.play().catch(()=>{});
  noise.play().catch(()=>{});

  const msg = document.createElement('div');
  msg.className = `msg ${faction.class}`;
  msg.textContent = `${faction.prefix} ${message}`;

  panel.appendChild(msg);
  panel.scrollTop = panel.scrollHeight;

  // Ограничение количества сообщений
  const msgs = panel.querySelectorAll('.msg');
  if (msgs.length > 70) msgs[0].remove();
}

// Генерация каждые 4 секунды
setInterval(generateRadioMessage, 4000);
for (let i = 0; i < 5; i++) generateRadioMessage();

// Отправка сообщения через Enter
const input = document.getElementById('inputField');
input.addEventListener('keydown', e => {
  if (e.key === 'Enter' && input.value.trim() !== '') {
    const msg = document.createElement('div');
    msg.className = 'msg volunteers'; // можно присвоить Волонтёры
    msg.textContent = `[ВЫ] ${input.value}`;
    panel.appendChild(msg);
    panel.scrollTop = panel.scrollHeight;
    input.value = '';
  }
});
</script>
</body>
</html>
