<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NOSTAI ‚Äî –•—Ä–æ–Ω–∏–∫–∏ –ó–∞–±–≤–µ–Ω–∏—è</title>
<link rel="icon" href="assets/images/favicon.png">
<style>
  @font-face {
    font-family: 'DestroyCyr';
    src: url('assets/fonts/destroycyr.ttf') format('truetype');
  }
  html, body {
    margin: 0;
    padding: 0;
    overflow: hidden;
    height: 100%;
    font-family: 'DestroyCyr', sans-serif;
    background: black;
    color: white;
  }
  #container {
    position: relative;
    width: 100%;
    height: 100%;
  }
  canvas {
    display: block;
  }
  #title {
    position: absolute;
    top: 5%;
    left: 50%;
    transform: translateX(-50%);
    font-size: 4em;
    color: #ffddaa;
    text-shadow: 0 0 20px #ffddaa, 0 0 40px #ffbb66;
    animation: glow 2s infinite alternate;
  }
  @keyframes glow {
    from { text-shadow: 0 0 10px #ffddaa, 0 0 20px #ffbb66; }
    to { text-shadow: 0 0 40px #ffddaa, 0 0 80px #ffbb66; }
  }
  #musicButton {
    position: absolute;
    bottom: 5%;
    left: 50%;
    transform: translateX(-50%);
    padding: 10px 20px;
    font-size: 1.2em;
    background: rgba(255,255,255,0.2);
    border: 2px solid #ffddaa;
    border-radius: 10px;
    color: #ffddaa;
    cursor: pointer;
    backdrop-filter: blur(5px);
  }
  #smokeOverlay {
    position: absolute;
    top:0;
    left:0;
    width:100%;
    height:100%;
    pointer-events:none;
    background: url('assets/images/smoke-fog.gif') center/cover no-repeat;
    mix-blend-mode: screen;
    opacity: 0.5;
  }
</style>
</head>
<body>
<div id="container">
  <div id="title">NOSTAI</div>
  <button id="musicButton">üîä –í–∫–ª—é—á–∏—Ç—å –º—É–∑—ã–∫—É</button>
  <div id="smokeOverlay"></div>
</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.152.2/examples/js/controls/OrbitControls.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.152.2/examples/js/loaders/TextureLoader.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.152.2/examples/js/loaders/FontLoader.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.152.2/examples/js/geometries/TextGeometry.js"></script>
<script src="https://cdn.jsdelivr.net/npm/gsap@3.13.2/dist/gsap.min.js"></script>

<script>
const container = document.getElementById('container');

// –°—Ü–µ–Ω–∞ –∏ –∫–∞–º–µ—Ä–∞
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(60, window.innerWidth/window.innerHeight, 0.1, 1000);
camera.position.set(0, 2, 8);

// –†–µ–Ω–¥–µ—Ä–µ—Ä
const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
renderer.setSize(window.innerWidth, window.innerHeight);
container.appendChild(renderer.domElement);

// –ö–æ–Ω—Ç—Ä–æ–ª—ã
const controls = new THREE.OrbitControls(camera, renderer.domElement);
controls.enablePan = false;
controls.enableZoom = false;

// –°–≤–µ—Ç
const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
scene.add(ambientLight);

const pointLight = new THREE.PointLight(0xffccaa, 1.2, 100);
pointLight.position.set(0,5,5);
scene.add(pointLight);

// –§–æ–Ω
const loader = new THREE.TextureLoader();
loader.load('assets/images/Nostai.png', function(texture){
  scene.background = texture;
});

// –§—Ä–∞–∫—Ü–∏–∏ ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∞–∫ –ø–ª–æ—Å–∫–æ—Å—Ç–∏
const factionImages = [
  'assets/images/–ì–æ–ª–æ—Å —Ç–µ–Ω–∏.png',
  'assets/images/–î–∞—Ä—ã –ø—Ä–æ–≤–∏–¥—Ü–µ–≤.png',
  'assets/images/–•—Ä–æ–Ω–∫–∏ –ó–∞–±–≤–µ–Ω–∏—è.png',
  'assets/images/–ø–æ—Ä–æ–≥ —Ç–∞–π–Ω—ã.png'
];
const factions = [];
const radius = 3;
const planeGeometry = new THREE.PlaneGeometry(1.5, 1.5);
factionImages.forEach((src, i)=>{
  const tex = loader.load(src);
  const mat = new THREE.MeshStandardMaterial({map: tex, transparent:true});
  const plane = new THREE.Mesh(planeGeometry, mat);
  const angle = i*Math.PI/2;
  plane.position.set(Math.cos(angle)*radius,0,Math.sin(angle)*radius);
  plane.lookAt(0,1,0); // —Å–ª–µ–≥–∫–∞ —Å–º–æ—Ç—Ä—è—Ç –∫ —Ü–µ–Ω—Ç—Ä—É
  scene.add(plane);
  factions.push(plane);

  gsap.to(plane.position, {y: "+=0.3", duration: 2, repeat:-1, yoyo:true, ease:"sine.inOut"});
  gsap.to(plane.rotation, {y: "+=0.5", duration: 4+Math.random()*2, repeat:-1, yoyo:true, ease:"sine.inOut"});
});

// –†—É–Ω—ã ‚Äî —Å —Ç–µ–∫—Å—Ç—É—Ä–æ–π –∏ –≤–∏–¥–µ–æ
const runeVideo = document.createElement('video');
runeVideo.src = 'assets/video/rune2.webm';
runeVideo.loop = true;
runeVideo.muted = true;
runeVideo.play();

const videoTexture = new THREE.VideoTexture(runeVideo);
const runeGeometry = new THREE.IcosahedronGeometry(0.2,0);
const runeMaterial = new THREE.MeshStandardMaterial({map: videoTexture, emissive:0xffcc77});
const runes = [];
for(let i=0;i<12;i++){
  const rune = new THREE.Mesh(runeGeometry, runeMaterial.clone());
  rune.position.set((Math.random()-0.5)*6, Math.random()*3+1, (Math.random()-0.5)*6);
  scene.add(rune);
  runes.push(rune);
  gsap.to(rune.position, {y: "+=0.5", duration: 3+Math.random()*2, repeat:-1, yoyo:true, ease:"sine.inOut"});
  gsap.to(rune.rotation, {y: "+=6.28", duration: 5+Math.random()*3, repeat:-1, ease:"linear"});
}

// –ê–Ω–∏–º–∞—Ü–∏—è —Å—Ü–µ–Ω—ã
function animate(){
  requestAnimationFrame(animate);
  renderer.render(scene,camera);
}
animate();

// –†–µ—Å–∞–π–∑
window.addEventListener('resize', ()=>{
  camera.aspect = window.innerWidth/window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth, window.innerHeight);
});

// –ú—É–∑—ã–∫–∞
const audio = new Audio('assets/music/–£—Ö–æ–¥—è—â–∞—è –°—É–¥—å–±–∞.mp3');
audio.loop = true;
const musicButton = document.getElementById('musicButton');
let musicPlaying = false;
musicButton.addEventListener('click', ()=>{
  if(!musicPlaying){
    audio.play();
    musicButton.textContent = "üîá –í—ã–∫–ª—é—á–∏—Ç—å –º—É–∑—ã–∫—É";
    musicPlaying = true;
  } else {
    audio.pause();
    musicButton.textContent = "üîä –í–∫–ª—é—á–∏—Ç—å –º—É–∑—ã–∫—É";
    musicPlaying = false;
  }
});

</script>
</body>
</html>
